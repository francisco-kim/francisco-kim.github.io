<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Francisco's musical notebook</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Dr. Francisco Kim" />
<meta name="description" content="Musical analysis of the Fuga I."
 />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/js/readtheorg.js"></script>
<style> #content{max-width:920px;}</style>
<style> p{max-width:870px;}</style>
<style> li{max-width:870px;}</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">Francisco's musical notebook</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org1d17b1f">Sitemap</a>
<ul>
<li><a href="#org258a7e0">♪&nbsp; Compositional ideas behind my Fuga I</a></li>
<li><a href="#orgb25d5e8">♪&nbsp; Some of my cryptograms to solve!</a></li>
</ul>
</li>
<li><a href="#orgf9c7464">Compositional ideas behind Fuga I</a></li>
<li><a href="#org61357f0">1. Introduction</a></li>
<li><a href="#orgf588141">2. Music/Score</a></li>
<li><a href="#org912ef31">3. Structural analysis</a>
<ul>
<li><a href="#org8f4da4b">3.1. Structure diagram</a></li>
<li><a href="#orge3299b4">3.2. Score analysis</a>
<ul>
<li><a href="#orgfdac58f">3.2.1. Entries/episodes</a></li>
<li><a href="#org3ac01dc">3.2.2. Subjects/countersujects and invertible counterpoint</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgccddd89">4. Specific details</a>
<ul>
<li><a href="#org4feea9c">4.1. Zenith/nadir of the piece</a></li>
<li><a href="#orgc4439dc">4.2. The strong-beat tritone in the lower voices</a></li>
<li><a href="#orgab31bb4">4.3. German sixth (übermässiger Quintsextakkord)</a></li>
<li><a href="#orgdffe323">4.4. Double sequence</a></li>
</ul>
</li>
<li><a href="#org9981531">5. Appendix</a>
<ul>
<li><a href="#org12a3182">5.1. Computational musicology</a>
<ul>
<li><a href="#orga42c0f4">5.1.1. Piano roll and other graphics</a></li>
<li><a href="#org8595ee6">5.1.2. Key center</a></li>
<li><a href="#orgcdc8bc5">5.1.3. Chords</a></li>
</ul>
</li>
<li><a href="#orgc7a5c18">5.2. Fractal intervallic scaling in Fuga I</a></li>
</ul>
</li>
</ul>
</div>
</div>
<a href="https://hits.seeyoufarm.com"><img src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Ffrancisco-kim.github.io&count_bg=%2379C83D&title_bg=%23555555&icon=applemusic.svg&icon_color=%23E7E7E7&title=+Music+lovers+count+++++&edge_flat=false" align="right"/></a>
<p>
<br />
</p>

<p>
Welcome to Francisco's personal musical "notebook/scrapbook"! This page contains notes, scribbles and doodles for my personal use, but you are very welcome to have a look at them!<br />
<br />
</p>

<div id="outline-container-org1d17b1f" class="outline-2">
<h2 id="org1d17b1f">Sitemap</h2>
<div class="outline-text-2" id="text-org1d17b1f">
</div>

<div id="outline-container-org258a7e0" class="outline-3">
<h3 id="org258a7e0">♪&nbsp; <a href="index.html">Compositional ideas behind my Fuga I</a></h3>
<div class="outline-text-3" id="text-org258a7e0">
</div>
</div>
<div id="outline-container-orgb25d5e8" class="outline-3">
<h3 id="orgb25d5e8">♪&nbsp; <a href="cryptograms.html">Some of my cryptograms to solve!</a></h3>
<div class="outline-text-3" id="text-orgb25d5e8">
<p>
<br />
<br />
</p>
</div>
</div>
</div>

<div id="outline-container-orgf9c7464" class="outline-2">
<h2 id="orgf9c7464">Compositional ideas behind Fuga I</h2>
<div class="outline-text-2" id="text-orgf9c7464">
<p>
This is a personal note of the musical ideas that were used in the composition of my Fuga I (all rights reserved, © 2020).<br />
<br />
</p>
</div>
</div>

<div id="outline-container-org61357f0" class="outline-2">
<h2 id="org61357f0"><span class="section-number-2">1</span> Introduction</h2>
<div class="outline-text-2" id="text-1">
<p>
In the composition of this fugue in D minor, the main idea was to use the <b>B-A-C-H motif</b> within the counterpoint rules of the Baroque period&#x2014;in particular in Bach's time. This means:<br />
</p>
<ul class="org-ul">
<li>avoid any parallel fifths/octaves and avoid direct fifths/octaves,<br /></li>
<li>avoid dissonances on strong/accented beats unless it is an essential dissonance<br /></li>
<li>resolve the melodies correctly (vertically and horizontally), e.g. the \(^{6}_{4}\) chords (2nd inversion triads) and the \(^{2}\) chords (3rd inversion seventh chords),<br /></li>
</ul>
<p>
among other general rules.<br />
</p>

<p>
The ideas that were used as guiding principles this fugue were as follows:<br />
</p>
<ul class="org-ul">
<li>Use and explore extensively the B-A-C-H motif and try to render this motif as melodious as possible<br /></li>
<li>Have a well-thought and well-built structure<br /></li>
<li>Employ the double/triple (invertible) counterpoint as much as possible.<br /></li>
</ul>
</div>
</div>

<div id="outline-container-orgf588141" class="outline-2">
<h2 id="orgf588141"><span class="section-number-2">2</span> Music/Score</h2>
<div class="outline-text-2" id="text-2">
<p>
The score can be found below, and the fugue can be played here:<br />
</p>
 <audio controls autoplay>
  <source src="./docs/assets/images/fuga_1/Fuga_I.mp3" type="audio/mpeg">
Your browser does not support the audio element.
</audio> 

<p alt="Fuga I image" title="Fuga I" align="center">
<img src="./docs/assets/images/fuga_1/scores/Fuga_I-1.png" alt="Fuga I image" title="Fuga I" align="center" /><br />
<img src="./docs/assets/images/fuga_1/scores/Fuga_I-2.png" alt="Fuga_I-2.png" /><br />
</p>
</div>
</div>

<div id="outline-container-org912ef31" class="outline-2">
<h2 id="org912ef31"><span class="section-number-2">3</span> Structural analysis</h2>
<div class="outline-text-2" id="text-3">
<p>
The structure diagram is shown in Figure <a href="#org1220b6e">1</a>. which shows schematically the location of the subject, countersubjects, episodes and the invertible counterpoints (inv. c.) amongst other indications. The scores with these indications can then be found in Subsection <a href="#orge3299b4">3.2</a>. The structure of the fugue with entries and episodes are shown on the <a href="#orgfdac58f">first score</a>. The highlighted subject,<br />
countersubjects and the inverted counterpoint are detailed on the <a href="#org3ac01dc">second score</a>.<br />
</p>
</div>

<div id="outline-container-org8f4da4b" class="outline-3">
<h3 id="org8f4da4b"><span class="section-number-3">3.1</span> Structure diagram</h3>
<div class="outline-text-3" id="text-3-1">

<div id="org1220b6e" class="figure">
<p><img src="./docs/assets/images/fuga_1/structure_table/fuga_1-analysis.png" alt="Fuga I image" title="Fuga I" align="center" /><br />
</p>
<p><span class="figure-number">Figure 1: </span>Structure diagram</p>
</div>

<p>
This fugue can be divided in three parts: measures 1-12 (in which all the voices enter successively, i.e., it is an exposition), measures 13-14 and measures 27-37. The final part of the fugue contains a stretto with an augmentation (in the upper voice) and a coda with a short (and repeated) episode that precedes it and that serves as a two-voice cadence. There is only one perfect authentic cadence in this piece with all the three voices, and it occurs at the end of the fugue. The voices collapse to just one voice at the very beginning of the coda, before opening up again with the successive entries of the subject in each voice.<br />
<br />
There is a notable deceptive cadence in measure 5 (V &rarr; VI [I]) and a quite brutal and sudden transition from F major to D minor in measure 24, whereas there is (only) one perfect authentic cadence in this piece with all the three voices&#x2013;it occurs at the end of the fugue which finishes with an Picardy third. The inverted counterpoint at the octave is profusely used in this fugue, and a voice is dropped from time to time at certain places in order to alleviate the texture of the fugue.<br />
</p>
</div>
</div>

<div id="outline-container-orge3299b4" class="outline-3">
<h3 id="orge3299b4"><span class="section-number-3">3.2</span> Score analysis</h3>
<div class="outline-text-3" id="text-3-2">
</div>
<div id="outline-container-orgfdac58f" class="outline-4">
<h4 id="orgfdac58f"><span class="section-number-4">3.2.1</span> Entries/episodes</h4>
<div class="outline-text-4" id="text-3-2-1">
<p alt="Entries/episodes analysis image" title="Entries/episodes analysis" align="center">
<img src="./docs/assets/images/fuga_1/scores/Fuga_I-analyse-structure-1.png" alt="Entries/episodes analysis image" title="Entries/episodes analysis" align="center" /><br />
<img src="./docs/assets/images/fuga_1/scores/Fuga_I-analyse-structure-2.png" alt="Fuga_I-analyse-structure-2.png" /><br />
</p>
</div>
</div>

<div id="outline-container-org3ac01dc" class="outline-4">
<h4 id="org3ac01dc"><span class="section-number-4">3.2.2</span> Subjects/countersujects and invertible counterpoint</h4>
<div class="outline-text-4" id="text-3-2-2">
<p alt="Subjects/countersujects and invertible counterpoint image" title="Subjects/countersujects and invertible counterpoint" align="center">
<img src="./docs/assets/images/fuga_1/scores/Fuga_I-analyse-sujets+counterpoint-1.png" alt="Subjects/countersujects and invertible counterpoint image" title="Subjects/countersujects and invertible counterpoint" align="center" /><br />
<img src="./docs/assets/images/fuga_1/scores/Fuga_I-analyse-sujets+counterpoint-2.png" alt="Fuga_I-analyse-sujets+counterpoint-2.png" /><br />
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-orgccddd89" class="outline-2">
<h2 id="orgccddd89"><span class="section-number-2">4</span> Specific details</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org4feea9c" class="outline-3">
<h3 id="org4feea9c"><span class="section-number-3">4.1</span> Zenith/nadir of the piece</h3>
<div class="outline-text-3" id="text-4-1">
<p>
The piece has a brief central part in the relative major (F major). The zenith of this fugue is in this F major section, which is generally in the higher pitch registry. The D minor section, in contrast, is much more grounded in the lower pitch registry.<br />
</p>
</div>
</div>

<div id="outline-container-orgc4439dc" class="outline-3">
<h3 id="orgc4439dc"><span class="section-number-3">4.2</span> The strong-beat tritone in the lower voices</h3>
<div class="outline-text-3" id="text-4-2">
<p>
In measure 9 (episode 2-1), the two lower voices form a tritone on the very first beat (<b>E</b> and \(\textbf{B}\flat\)) which is not allowed in principle (the fact that the dissonant interval is with the bass AND the fact that the dissonance is on the first beat). This is the only place in this fugue where such a dissonance occur, and this is to stress the B-A-C-H motif that enters with an augmentation with respect to the subject.<br />
</p>
</div>
</div>

<div id="outline-container-orgab31bb4" class="outline-3">
<h3 id="orgab31bb4"><span class="section-number-3">4.3</span> German sixth (übermässiger Quintsextakkord)</h3>
<div class="outline-text-3" id="text-4-3">

<div id="org47d568e" class="figure">
<p><img src="./docs/assets/images/fuga_1/german_sixth.png" alt="german_sixth.png" /><br />
</p>
<p><span class="figure-number">Figure 2: </span>(Suggested) German sixth chord without the fifth.</p>
</div>

<p>
The B-A-C-H motif is a chromatically difficult melodic/harmonic line to handle. This can give rise to many exciting melodic and harmonic possibilities in a freer setting of course, but it can be a difficult task within the rules of strict counterpoint.<br />
</p>

<p>
This motif sounds mysterious and very eerie when the third voice hasn't entered yet, as the harmonic suggestion is not yet clear without the third voice and the chromatic voices are very dissonant. However, the entry of the third voice suggests a very interesting harmonic progression, with the middle voice (the secound countersubject) having a delayed resolution after the B-A-C-H motif (the augmented interval within the middle voice should be followed by a contrary motion first).<br />
</p>

<p>
The <b>D\(\sharp\)</b> (<b>Dis</b>) suggests the <b>VII</b> degree of <b>E</b>, and one way of understanding this functionally is to think of it as the German sixth&#x2013;with the fifth omitted&#x2013;in the tonality of <b>E</b>, i.e., a chord with \(\sharp\text{IV}-\flat\text{VI}-\text{I (omitted)}-\text{III}\). It is then resolved in one of the traditional ways in the tonality of <b>A</b>.<br />
</p>
</div>
</div>

<div id="outline-container-orgdffe323" class="outline-3">
<h3 id="orgdffe323"><span class="section-number-3">4.4</span> Double sequence</h3>
<div class="outline-text-3" id="text-4-4">

<div id="org2212213" class="figure">
<p><img src="./docs/assets/images/fuga_1/double_sequence.png" alt="double_sequence.png" /><br />
</p>
<p><span class="figure-number">Figure 3: </span>The double sequence with the pattern and imitative sequence used in all the voices.</p>
</div>

<p>
This passage is a double sequence, where a pattern and an imitative sequence&#x2013;a sequence in which voices imitate other voices&#x2013;is again used as an (inclusive) sequence. The imitative sequence is built such that the alto/tenor voice in the middle has a dactyl against an anapaest successively: making a nod to the second half of the subject.<br />
</p>

<p>
Harmonically, the passage goes through the cycle of fifths "downwards". At the end of each measure, the last note of the middle voice is the seventh of the chords which should be resolved downwards by a half step (scale degree <b>IV</b> should, in principle, resolve down to <b>III</b>). However, as another voice (soprano) takes over the seventh of the chord and then resolves down correctly, the middle voice can go up a step to avoid a parallel octave. In this case, this also ensures that we have an inclusive sequence (i.e., in all the voices) by a step.<br />
</p>


<div id="orgfe11f97" class="figure">
<p><img src="./docs/assets/images/fuga_1/double_sequence-end.png" alt="double_sequence-end.png" /><br />
</p>
<p><span class="figure-number">Figure 4: </span>Measure wrapping up the double sequence which is again an imitative sequence.</p>
</div>

<p>
Following the idea of <i>pattern &rarr; sequence &rarr; contrast</i> (or <i>idea - &rarr; repetition &rarr; contrast/altered repetition)</i>, the next measure pursues a different melodic motifs. However, one of them is a recall of one of the motifs from the double sequence which allows a certain continuity with the double sequence. This passage is also an imitative sequence with a series of imperfect consonances (thirds and sixths), making these three measures complex yet beautiful with a lot of structure and symmetry. They come back once more later in the fugue as a triple counterpoint.<br />
</p>
</div>
</div>
</div>

<div id="outline-container-org9981531" class="outline-2">
<h2 id="org9981531"><span class="section-number-2">5</span> Appendix</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-org12a3182" class="outline-3">
<h3 id="org12a3182"><span class="section-number-3">5.1</span> Computational musicology</h3>
<div class="outline-text-3" id="text-5-1">
<p>
We now analyse the fugue with <a href="https://web.mit.edu/music21/"><code>music21</code></a> (v6.7 in this appendix), a <i>python</i> package developed by MIT for computer-aided musicology.<br />
</p>
</div>
<div id="outline-container-orga42c0f4" class="outline-4">
<h4 id="orga42c0f4"><span class="section-number-4">5.1.1</span> Piano roll and other graphics</h4>
<div class="outline-text-4" id="text-5-1-1">
<p>
First initialise <code>music21</code>:<br />
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">from</span> music21 <span class="org-keyword">import</span> *
<span class="org-comment-delimiter"># </span><span class="org-comment">environment.set('musescoreDirectPNGPath', '~/.myscript/MuseScore-3.6.2-x86_64.AppImage')</span>

<span class="org-variable-name">path</span> = <span class="org-string">'../music21/Fuga I analysis with music21.musicxml'</span>
<span class="org-variable-name">fugue</span> = converter.parse(path)
</pre>
</div>

<p>
We can then plot the piano roll:<br />
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-comment-delimiter"># </span><span class="org-comment">fugue.plot('pianoroll')</span>

<span class="org-variable-name">roll</span> = graph.plot.HorizontalBarPitchSpaceOffset(fugue)
<span class="org-variable-name">roll.title</span> = <span class="org-string">'Piano roll of Fuga I'</span>
<span class="org-variable-name">roll.figureSize</span> = (12, 6)
roll.run()
</pre>
</div>


<div class="figure">
<p><img src="./docs/assets/images/fuga_1/pianoRoll.png" alt="pianoRoll.png" /><br />
</p>
</div>

<p>
And plot it with pitch classes this time:<br />
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-comment-delimiter"># </span><span class="org-comment">fugue.plot('pianoroll')</span>

<span class="org-variable-name">roll</span> = graph.plot.HorizontalBarPitchClassOffset(fugue)
<span class="org-variable-name">roll.title</span> = <span class="org-string">'Piano roll of Fuga I'</span>
<span class="org-variable-name">roll.figureSize</span> = (12, 6)
roll.run()
</pre>
</div>


<div class="figure">
<p><img src="./docs/assets/images/fuga_1/pitchClass.png" alt="pitchClass.png" /><br />
</p>
</div>

<p>
By using the spline interpolation, we can plot the notes as smoothed-out curves:<br />
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">import</span> numpy <span class="org-keyword">as</span> np
<span class="org-keyword">import</span> matplotlib.pyplot <span class="org-keyword">as</span> plt
<span class="org-keyword">from</span> scipy <span class="org-keyword">import</span> interpolate

<span class="org-variable-name">fig</span> = plt.figure()
<span class="org-variable-name">subplot</span> = fig.add_subplot(1, 1, 1)

<span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(<span class="org-builtin">len</span>(fugue.parts)):
    <span class="org-variable-name">top</span> = fugue.parts[i].flat.notes
    <span class="org-variable-name">y</span> = [n.pitch.ps <span class="org-keyword">for</span> n <span class="org-keyword">in</span> top]
    <span class="org-variable-name">x</span> = [n.offset + n.quarterLength/2.0 <span class="org-keyword">for</span> n <span class="org-keyword">in</span> top]

    <span class="org-variable-name">tick</span> = interpolate.splrep(x, y, s=0)
    <span class="org-variable-name">xnew</span> = np.arange(x[0], <span class="org-builtin">max</span>(x), 0.01)
    <span class="org-variable-name">ynew</span> = interpolate.splev(xnew, tick, der=0)

    subplot.plot(xnew, ynew)
    subplot.spines[<span class="org-string">'top'</span>].set_color(<span class="org-string">'none'</span>)
    subplot.spines[<span class="org-string">'right'</span>].set_color(<span class="org-string">'none'</span>)

plt.title(<span class="org-string">'Fuga I motion'</span>)

plt.show()
</pre>
</div>


<div class="figure">
<p><img src="./docs/assets/images/fuga_1/Pitch-interpolation.png" alt="Pitch-interpolation.png" /><br />
</p>
</div>
</div>
</div>

<div id="outline-container-org8595ee6" class="outline-4">
<h4 id="org8595ee6"><span class="section-number-4">5.1.2</span> Key center</h4>
<div class="outline-text-4" id="text-5-1-2">
<p>
The key is found using the <a href="https://rnhart.net/articles/key-finding/">Krumhansl-Schmuckler key-finding algorithm</a> which uses the correlation coefficient<br />
\[R = \frac{\sum\limits_{i=1}^{n}(x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum\limits_{i=1}^{n}(x_i - \bar{x})^2 \sum\limits_{i=1}^{n}(y_i - \bar{y})^2}}\]<br />
in which one coordinate is the <b>profile</b> of each note in a major or minor key and the other coordinate is the <b>total duration</b> of each pitch class. The profiles have been empirically established values.<br />
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-variable-name">tonality</span> = fugue.analyze(<span class="org-string">'key'</span>)
tonality
</pre>
</div>

<pre class="example">
&lt;music21.key.Key of d minor&gt;

</pre>

<p>
The correlation coefficient is then given by<br />
</p>

<div class="org-src-container">
<pre class="src src-python">tonality.correlationCoefficient
</pre>
</div>

<pre class="example">
# Out[213]:
: 0.9486855347153584

</pre>

<p>
The correlation coefficient of other candidate keys:<br />
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">import</span> matplotlib.pyplot <span class="org-keyword">as</span> plt
<span class="org-keyword">import</span> numpy <span class="org-keyword">as</span> np
plt.figure(figsize=(12, 6))

<span class="org-variable-name">alternateKeys</span> = [tonality] + tonality.alternateInterpretations

<span class="org-variable-name">keys</span> = [<span class="org-builtin">str</span>(alternateKeys[i]).split()[0] <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(<span class="org-builtin">len</span>(alternateKeys))]
<span class="org-variable-name">corrCoeffs</span> = [alternateKeys[i].correlationCoefficient <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(<span class="org-builtin">len</span>(alternateKeys))]

<span class="org-variable-name">xPos</span> = np.arange(<span class="org-builtin">len</span>(keys))
plt.xticks(xPos, keys)

plt.xlabel(<span class="org-string">'Key'</span>)
plt.ylabel(<span class="org-string">'Correlation coefficient'</span>)
plt.title(<span class="org-string">'Correlation coefficients of the candidate keys'</span>)
plt.tick_params(axis = <span class="org-string">"x"</span>, bottom = <span class="org-constant">False</span>)

plt.bar(xPos, corrCoeffs, align=<span class="org-string">'center'</span>, width=0.8)

plt.show()
</pre>
</div>


<div class="figure">
<p><img src="docs/assets/images/fuga_1/tonal_probability.png" alt="tonal_probability.png" /><br />
</p>
</div>

<p>
The histogram of the pitch classes:<br />
</p>

<div class="org-src-container">
<pre class="src src-python">fugue.plot(<span class="org-string">'histogram'</span>, <span class="org-string">'pitchClass'</span>)
</pre>
</div>


<div class="figure">
<p><img src="./docs/assets/images/fuga_1/histogram-pitchClass.png" alt="histogram-pitchClass.png" /><br />
</p>
</div>

<p>
The histogram of all the pitches:<br />
</p>

<div class="org-src-container">
<pre class="src src-python">fugue.plot(<span class="org-string">'histogram'</span>, <span class="org-string">'pitch'</span>)
</pre>
</div>


<div class="figure">
<p><img src="./docs/assets/images/fuga_1/histogram-pitch.png" alt="histogram-pitch.png" /><br />
</p>
</div>

<p>
The scatter plot with measures and pitch classes:<br />
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-variable-name">scatter</span> = graph.plot.ScatterPitchClassOffset(fugue)
<span class="org-variable-name">scatter.title</span> = <span class="org-string">'Fuga I and its notes'</span>
<span class="org-variable-name">scatter.figureSize</span> = (12, 6)
scatter.run()
</pre>
</div>


<div class="figure">
<p><img src="./docs/assets/images/fuga_1/Scatter-pitchClass.png" alt="Scatter-pitchClass.png" /><br />
</p>
</div>

<p>
The scatter plot with the pitch class by quarter length:<br />
</p>

<div class="org-src-container">
<pre class="src src-python">fugue.plot(<span class="org-string">'scatter'</span>, <span class="org-string">'pitchClass'</span>, <span class="org-string">'quarterLength'</span>)
</pre>
</div>


<div class="figure">
<p><img src="./docs/assets/images/fuga_1/scatter-pitchClass-quarterLength.png" alt="scatter-pitchClass-quarterLength.png" /><br />
</p>
</div>

<p>
And in 3D:<br />
</p>

<div class="org-src-container">
<pre class="src src-python">fugue.plot(<span class="org-string">'3dbars'</span>)
</pre>
</div>


<div class="figure">
<p><img src="./docs/assets/images/fuga_1/scatter-pitchClass-quarterLength-3D.png" alt="scatter-pitchClass-quarterLength-3D.png" /><br />
</p>
</div>
</div>
</div>

<div id="outline-container-orgcdc8bc5" class="outline-4">
<h4 id="orgcdc8bc5"><span class="section-number-4">5.1.3</span> Chords</h4>
<div class="outline-text-4" id="text-5-1-3">
<p>
We now combine the three voices into <code>Chord</code> objects:<br />
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-comment-delimiter"># </span><span class="org-comment">Chordify fugue</span>
<span class="org-variable-name">chords</span> = fugue.chordify()

<span class="org-comment-delimiter"># </span><span class="org-comment">Insert chords in fugue</span>
fugue.insert(0, chords)

<span class="org-comment-delimiter"># </span><span class="org-comment">Chords closed position</span>
<span class="org-keyword">for</span> c <span class="org-keyword">in</span> chords.recurse().getElementsByClass(<span class="org-string">'Chord'</span>):
    c.closedPosition(forceOctave=4, inPlace=<span class="org-constant">True</span>)

<span class="org-comment-delimiter"># </span><span class="org-comment">Add Roman numeral analysis</span>
<span class="org-keyword">for</span> c <span class="org-keyword">in</span> chords.recurse().getElementsByClass(<span class="org-string">'Chord'</span>):
    <span class="org-variable-name">rn</span> = roman.romanNumeralFromChord(c, key.Key(<span class="org-string">'d'</span>))
    c.addLyric(<span class="org-builtin">str</span>(rn.figure))

<span class="org-comment-delimiter"># </span><span class="org-comment">Show</span>
fugue.measures(0,12).show()
</pre>
</div>


<div class="figure">
<p><img src="./docs/assets/images/fuga_1/romanAnalysis.png" alt="romanAnalysis.png" /><br />
</p>
</div>

<p>
One possibility would be as follows:<br />
</p>
<div class="org-src-container">
<pre class="src src-python"><span class="org-variable-name">chordsFlat</span> = chords.flat
<span class="org-variable-name">onlyChords</span> = chordsFlat.getElementsByClass(<span class="org-string">'Chord'</span>)

<span class="org-variable-name">displayPart</span> = stream.Part(<span class="org-builtin">id</span>=<span class="org-string">'displayPart'</span>)

<span class="org-keyword">def</span> <span class="org-function-name">appendChordPairs</span>(thisChord, nextChord):
<span class="org-comment-delimiter">#    </span><span class="org-comment">if ((thisChord.isTriad() is True or</span>
<span class="org-comment-delimiter">#            </span><span class="org-comment">thisChord.isSeventh() is True) and</span>
<span class="org-comment-delimiter">#                </span><span class="org-comment">thisChord.root().name == 'D'):</span>
    <span class="org-variable-name">closePositionThisChord</span> = thisChord.closedPosition(forceOctave=4)
    <span class="org-variable-name">closePositionNextChord</span> = nextChord.closedPosition(forceOctave=4)

    <span class="org-variable-name">m</span> = stream.Measure()
    m.append(closePositionThisChord)
    m.append(closePositionNextChord)
    displayPart.append(m)

<span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(<span class="org-builtin">len</span>(onlyChords) - 1):
    <span class="org-variable-name">thisChord</span> = onlyChords[i]
    <span class="org-variable-name">nextChord</span> = onlyChords[i + 1]
    appendChordPairs(thisChord, nextChord)

displayPart.show()
</pre>
</div>

<p>
But we will do something simpler and better adapted to our case:<br />
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-variable-name">chordsFlat</span> = chords.flat
<span class="org-variable-name">onlyChords</span> = chordsFlat.getElementsByClass(<span class="org-string">'Chord'</span>)

onlyChords.measures(0,37).show()
</pre>
</div>


<div class="figure">
<p><img src="./docs/assets/images/fuga_1/romanAnalysis-onlyChords.png" alt="romanAnalysis-onlyChords.png" /><br />
</p>
</div>

<p>
With the chords, it is possible to analyse the key of each measures:<br />
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">for</span> m <span class="org-keyword">in</span> chords.getElementsByClass(<span class="org-string">'Measure'</span>):
    <span class="org-variable-name">k</span> = m.analyze(<span class="org-string">'key'</span>)
    <span class="org-keyword">print</span>(m.number, k)
</pre>
</div>

<pre class="example">
1 a minor
2 b- minor
3 d minor
4 a minor
5 d minor
6 g minor
7 d minor
8 d minor
9 a minor
10 D major
11 C major
12 F major
13 F major
14 g minor
15 F major
16 d minor
...
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc7a5c18" class="outline-3">
<h3 id="orgc7a5c18"><span class="section-number-3">5.2</span> Fractal intervallic scaling in Fuga I</h3>
<div class="outline-text-3" id="text-5-2">
<p>
There is evidence that Bach's music could be fractal, in the sense that it can exhibit pitch, interval or structural-related scaling laws <sup><a id="fnr.1" class="footref" href="#fn.1">1</a></sup> <sup>, </sup><sup><a id="fnr.2" class="footref" href="#fn.2">2</a></sup>. A theoretical physicist's perspective of this would be the concept of universality in statistical mechanics at critical points of a system.<br />
</p>

<p>
Here, we investigate the possibility of having an interval-related scaling law in the Fuga I. In the musical sense, the structure-related scaling might be understood easily when we think of the augmentation and the diminution of the subject, for instance. The indication that the distribution of the interval counts is fractal, however, is a bit more puzzling. This likely stems from the fact that the stepwise motion is favoured as opposed to skips and leaps.<br />
</p>

<p>
Let us first count the number of existing intervals per voice:<br />
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">from</span> music21 <span class="org-keyword">import</span> *
<span class="org-keyword">import</span> numpy <span class="org-keyword">as</span> np
<span class="org-keyword">from</span> sklearn.linear_model <span class="org-keyword">import</span> LinearRegression
<span class="org-keyword">import</span> matplotlib.pyplot <span class="org-keyword">as</span> plt
<span class="org-keyword">from</span> collections <span class="org-keyword">import</span> Counter

<span class="org-comment-delimiter"># </span><span class="org-comment">Import Fuga I</span>
<span class="org-variable-name">path</span> = <span class="org-string">'./Fuga I analysis with music21.musicxml'</span>
<span class="org-variable-name">fugue</span> = converter.parse(path)

<span class="org-comment-delimiter"># </span><span class="org-comment">Get notes &amp; intervals per voice (1, 2, 3) and then merge</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">all of them (hence length = 4).</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">Voice 1: soprano (last entry) / Voice 2: tenor/alto (first entry) /</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">Voice 3: bass (second entry) / Voice 4: all</span>
<span class="org-variable-name">notes</span> = []
<span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(<span class="org-builtin">len</span>(fugue.parts)):
    <span class="org-variable-name">pitchesPerVoice</span> = fugue.parts[i].flat.notes
    notes.append([n.pitch.ps <span class="org-keyword">for</span> n <span class="org-keyword">in</span> pitchesPerVoice])
notes.append([note <span class="org-keyword">for</span> voice <span class="org-keyword">in</span> notes <span class="org-keyword">for</span> note <span class="org-keyword">in</span> voice])

<span class="org-variable-name">intervals</span> = []
<span class="org-keyword">for</span> voiceNotes <span class="org-keyword">in</span> notes:
    <span class="org-variable-name">intervalsPerVoice</span> = []
    <span class="org-keyword">for</span> j <span class="org-keyword">in</span> <span class="org-builtin">range</span>(<span class="org-builtin">len</span>(<span class="org-builtin">list</span>(voiceNotes))-1):
        intervalsPerVoice.append(<span class="org-builtin">abs</span>(voiceNotes[j+1]-voiceNotes[j]))
    intervals.append(intervalsPerVoice)

<span class="org-comment-delimiter"># </span><span class="org-comment">Show existing intervals in the Fuga I</span>
analysis.discrete.MelodicIntervalDiversity().countMelodicIntervals(fugue.parts)
</pre>
</div>

<pre class="example">
{'P4': [&lt;music21.interval.Interval P4&gt;, 48],
'm2': [&lt;music21.interval.Interval m2&gt;, 190],
'm3': [&lt;music21.interval.Interval m3&gt;, 56],
'M2': [&lt;music21.interval.Interval M2&gt;, 264],
'd4': [&lt;music21.interval.Interval d4&gt;, 3],
'm6': [&lt;music21.interval.Interval m6&gt;, 11],
'A1': [&lt;music21.interval.Interval A1&gt;, 14],
'M6': [&lt;music21.interval.Interval M6&gt;, 15],
'M3': [&lt;music21.interval.Interval M3&gt;, 16],
'A2': [&lt;music21.interval.Interval A2&gt;, 3],
'P11': [&lt;music21.interval.Interval P11&gt;, 1],
'P5': [&lt;music21.interval.Interval P5&gt;, 8],
'm14': [&lt;music21.interval.Interval m14&gt;, 1],
'P8': [&lt;music21.interval.Interval P8&gt;, 5],
'M10': [&lt;music21.interval.Interval M10&gt;, 1],
'd5': [&lt;music21.interval.Interval d5&gt;, 1]}
</pre>

<p>
Now count intervals for each voice:<br />
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-variable-name">intervalCounts</span> = []
<span class="org-variable-name">sortedIntervalCounts</span> = []
<span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(<span class="org-builtin">len</span>(intervals)):
    <span class="org-variable-name">intervalCount</span> = Counter(intervals[i])
    <span class="org-variable-name">sortedIntervalCount</span> = <span class="org-builtin">sorted</span>(intervalCount.items())

    intervalCounts.append(intervalCount)
    sortedIntervalCounts.append(sortedIntervalCount)

    <span class="org-keyword">print</span>(<span class="org-string">"Voice {}: {}"</span>.<span class="org-builtin">format</span>(i+1, sortedIntervalCounts[i]))
</pre>
</div>

<pre class="example">
Voice 1: [(0.0, 5), (1.0, 59), (2.0, 86), (3.0, 15), (4.0, 6), (5.0, 16), (8.0, 3), (9.0, 5), (17.0, 1)]
Voice 2: [(0.0, 9), (1.0, 76), (2.0, 86), (3.0, 26), (4.0, 8), (5.0, 19), (7.0, 3), (8.0, 3), (9.0, 6), (12.0, 1), (22.0, 1)]
Voice 3: [(0.0, 4), (1.0, 69), (2.0, 92), (3.0, 18), (4.0, 5), (5.0, 13), (6.0, 1), (7.0, 5), (8.0, 5), (9.0, 4), (12.0, 4), (16.0, 1)]
Voice 4: [(0.0, 18), (1.0, 204), (2.0, 264), (3.0, 59), (4.0, 19), (5.0, 48), (6.0, 1), (7.0, 8), (8.0, 11), (9.0, 16), (12.0, 6), (16.0, 1), (17.0, 1), (22.0, 1)]

</pre>

<p>
Let us now choose the bin size (as well as how to treat the intervals) of each voice by considering the melodies. In other words, let us take into account the melodic jump between measures 26 and 28 for the analysis of the soprano voice (voice 1), i.e., we omit the intervals larger than 9 semitones. For the tenor/alto voice (voice 2), the jump in measure 25 and the octave jump in 27 will be considered. Lastly, the bass voice (voice 3) will exclude the jump between measures 12 and 13:<br />
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-comment-delimiter"># </span><span class="org-comment">Voice 1</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">Jump in measures 26-28</span>
<span class="org-variable-name">bins1</span> = [0, 3, 6, 9]
<span class="org-variable-name">foldedIntervals1</span> = [i <span class="org-keyword">for</span> i <span class="org-keyword">in</span> intervals[0] <span class="org-keyword">if</span> i &lt;= 9]    <span class="org-comment-delimiter"># </span><span class="org-comment">omitted after 9</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Voice 2</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">Jump in measure 25 &amp; octave jump in 27</span>
<span class="org-variable-name">bins2</span> = [0, 3, 6, 9]
<span class="org-variable-name">foldedIntervals2</span> = [i <span class="org-keyword">for</span> i <span class="org-keyword">in</span> intervals[1] <span class="org-keyword">if</span> i &lt;= 9]    <span class="org-comment-delimiter"># </span><span class="org-comment">omitted after 9</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Voice 3 </span>
<span class="org-comment-delimiter"># </span><span class="org-comment">Jump in measures 12-13</span>
<span class="org-variable-name">bins3</span> = [0, 3, 6, 9, 12]
<span class="org-variable-name">foldedIntervals3</span> = [i <span class="org-keyword">for</span> i <span class="org-keyword">in</span> intervals[2] <span class="org-keyword">if</span> i &lt;= 12]    <span class="org-comment-delimiter"># </span><span class="org-comment">Omitted after 12</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">All the voices</span>
<span class="org-variable-name">bins4</span> = [0, 5, 10, 16]
<span class="org-variable-name">foldedIntervals4</span> = [i <span class="org-keyword">for</span> i <span class="org-keyword">in</span> intervals[3] <span class="org-keyword">if</span> i &lt;= 16]    <span class="org-comment-delimiter"># </span><span class="org-comment">Omitted after 16</span>
</pre>
</div>

<p>
The bin \(0-3\), for instance, includes the interval 0 but not the interval 3. This is true for all bins except for the last bins that include the supremum. The last bins can also be stretched to accommodate the extremal intervals that are used sparingly in music.<br />
</p>

<p>
As an example, when looking at all the melodies together after our choice of bin size and interval treatment, the following intervals remain:<br />
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-variable-name">bins</span> = [bins1, bins2, bins3, bins4]
<span class="org-variable-name">foldedIntervals</span> = [foldedIntervals1, foldedIntervals2, foldedIntervals3, foldedIntervals4]

<span class="org-variable-name">newIntervalCounts</span> = [np.histogram(foldedIntervals[i], bins=bins[i])[0] <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(4)]

<span class="org-variable-name">newFoundIntervals</span> = []
<span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(4):
    <span class="org-variable-name">newIntervals</span> = []
    <span class="org-keyword">for</span> j <span class="org-keyword">in</span> <span class="org-builtin">range</span>(<span class="org-builtin">len</span>(bins[i])-1):
        newIntervals.append((bins[i][j] + bins[i][j+1])/2)
    newFoundIntervals.append(newIntervals)

<span class="org-builtin">sorted</span>(Counter(foldedIntervals[3]).items())
</pre>
</div>

<pre class="example">
[(0.0, 18),
(1.0, 204),
(2.0, 264),
(3.0, 59),
(4.0, 19),
(5.0, 48),
(6.0, 1),
(7.0, 8),
(8.0, 11),
(9.0, 16),
(12.0, 6),
(16.0, 1)]
</pre>

<p>
Finally, the final fractal dimension of the Fuga I is shown here:<br />
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-variable-name">figIndex</span> = 3
<span class="org-variable-name">xOrig</span> = np.array(newFoundIntervals[figIndex]).reshape((-1, 1))
<span class="org-variable-name">f</span> = <span class="org-keyword">lambda</span> k: 2 ** (k/12)
<span class="org-variable-name">x</span> = np.log(f(xOrig))
<span class="org-variable-name">y</span> = np.log(np.array(newIntervalCounts[figIndex]))

<span class="org-variable-name">linearRegression</span> = LinearRegression()
<span class="org-variable-name">model</span> = linearRegression.fit(x, y)
<span class="org-variable-name">y_pred</span> = linearRegression.predict(x)
<span class="org-variable-name">r_sq</span> = model.score(x, y)

<span class="org-comment-delimiter"># </span><span class="org-comment">Plot</span>
fig, (ax1) = plt.subplots(nrows=1, ncols=1, figsize = (6,4))

ax1.scatter(x, y, color=<span class="org-string">"black"</span>)
ax1.plot(x, y_pred, color=<span class="org-string">"blue"</span>, linewidth=3, \
         label=r<span class="org-string">'$\log(N) = C - d_{f}\, \log(2^{i/12})$'</span>)

ax1.set_xlabel(r<span class="org-string">'$\log(2^{i/12})$'</span>, fontsize=10)
ax1.set_ylabel(r<span class="org-string">'$\log(N)$'</span>, fontsize=10)

ax1.set_title(<span class="org-string">'All the voices'</span>, fontsize=12)
ax1.text(0.9, 0.6, \
         r<span class="org-string">'$d_{f} =$'</span> + <span class="org-builtin">str</span>(<span class="org-builtin">round</span>(-linearRegression.coef_[0], 3)) + <span class="org-string">'\n \n'</span> + r<span class="org-string">'$R^{2} =$'</span> + f<span class="org-string">'{r_sq:.3f}'</span>, \
         horizontalalignment=<span class="org-string">'center'</span>, verticalalignment=<span class="org-string">'center'</span>, fontsize=10, transform=ax1.transAxes)
ax1.text(0.03, 0.06, <span class="org-string">'Bins: '</span> + f<span class="org-string">'{bins[figIndex]}'</span>, \
         horizontalalignment=<span class="org-string">'left'</span>, fontsize=6, transform=ax1.transAxes)
ax1.legend(numpoints=1, loc=1, fontsize=7)

plt.show()
</pre>
</div>


<div class="figure">
<p><img src="./docs/assets/images/fuga_1/fractal_AllVoices.png" alt="fractal_AllVoices.png" /><br />
</p>
</div>

<p>
We now show the anaylsis for separate voices as well, where the most coherent bin size and the interval treatment (with respect to the music structure and the musical ideas) have been selected, as mentioned above:<br />
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-variable-name">f</span> = <span class="org-keyword">lambda</span> k: 2 ** (k/12)

<span class="org-variable-name">xOrig</span> = [np.array(newFoundIntervals[i]).reshape((-1, 1)) <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(4)]
<span class="org-variable-name">x</span> = [np.log(f(xOrig[i])) <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(4)]
<span class="org-variable-name">y</span> = [np.log(np.array(newIntervalCounts[i])) <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(4)]

<span class="org-variable-name">linearRegression</span> = [LinearRegression() <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(4)]
<span class="org-variable-name">model</span> = [linearRegression[i].fit(x[i], y[i]) <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(4)]
<span class="org-variable-name">y_pred</span> = [linearRegression[i].predict(x[i]) <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(4)]
<span class="org-variable-name">r_sq</span> = [model[i].score(x[i], y[i]) <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(4)]

<span class="org-comment-delimiter"># </span><span class="org-comment">Plot</span>
<span class="org-comment-delimiter">#</span><span class="org-comment">fig, axs = plt.subplots(nrows=2, ncols=2, figsize = (6,4), tight_layout = True)</span>
<span class="org-variable-name">fig</span>, <span class="org-variable-name">axs</span> = plt.subplots(nrows=2, ncols=2, figsize = (9,6))
fig.subplots_adjust(hspace = .6, wspace=.3)
<span class="org-variable-name">axs</span> = axs.ravel()

<span class="org-variable-name">titles</span> = [<span class="org-string">'Voice 1'</span>, <span class="org-string">'Voice 2'</span>, <span class="org-string">'Voice 3'</span>, <span class="org-string">'All the voices'</span>]

<span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(4):
    axs[i].scatter(x[i], y[i], color=<span class="org-string">"black"</span>)
    axs[i].plot(x[i], y_pred[i], color=<span class="org-string">"blue"</span>, linewidth=3, \
                label=r<span class="org-string">'$\log(N) = C - d_{f}\, \log(2^{i/12})$'</span>)
    axs[i].set_xlabel(r<span class="org-string">'$\log(2^{i/12})$'</span>, fontsize=10)
    axs[i].set_ylabel(r<span class="org-string">'$\log(N)$'</span>, fontsize=10)
    axs[i].set_title(f<span class="org-string">'{titles[i]}'</span>, fontsize=12)
    axs[i].text(0.85, 0.62, \
                r<span class="org-string">'$d_{f} =$'</span> + <span class="org-builtin">str</span>(<span class="org-builtin">round</span>(-linearRegression[i].coef_[0], 3)) + <span class="org-string">'\n \n'</span> + r<span class="org-string">'$R^{2} =$'</span> + <span class="org-builtin">str</span>(<span class="org-builtin">round</span>(r_sq[i], 3)), \
                horizontalalignment=<span class="org-string">'center'</span>, verticalalignment=<span class="org-string">'center'</span>, fontsize=10, transform=axs[i].transAxes)
    axs[i].text(0.03, 0.06, <span class="org-string">'Bins: '</span> + f<span class="org-string">'{bins[i]}'</span>, \
                horizontalalignment=<span class="org-string">'left'</span>, fontsize=6, transform=axs[i].transAxes)
    axs[i].legend(numpoints=1, loc=1, fontsize=7)

plt.show()
</pre>
</div>


<div class="figure">
<p><img src="./docs/assets/images/fuga_1/fractal_individualVoices.png" alt="fractal_individualVoices.png" /><br />
</p>
</div>

<p>
The fit using three points only could make us doubt that the interval distribution is really fractal. But it should be reminded that such a fractal law in music should only arise after some coarse-graining at a larger scale. And since that an octave is divided in 12 semitones only and that the musically coherent intervals are quite limited, finishing with three points only at the end of the binning does not seem unreasonable. And a linear fit of three points is by no means a trivial guarantee :).<br />
</p>

<p>
It should also be noted, however, that the dimension and the \(R^2\) are all quite sensitive to the bin size and the way we treat the intervals. For completeness, here are some of the results with different configurations:<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 1:</span> Voice 1 binned differently with different interval treatments. The selected version (red line) takes into account the jump in measures 26-28.</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>

<colgroup>
<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Bins</th>
<th scope="col" class="org-left">Intervals</th>
<th scope="col" class="org-right">\(d_{f}\)</th>
<th scope="col" class="org-right">\(R^{2}\)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">0-2, 2-4, 4-6, 6-9, 9-17</td>
<td class="org-left">All the intervals</td>
<td class="org-right">4.432</td>
<td class="org-right">0.626</td>
</tr>

<tr>
<td class="org-left">0-2, 2-4, 4-6, 6-9</td>
<td class="org-left">Omitted after 9</td>
<td class="org-right">6.321</td>
<td class="org-right">0.800</td>
</tr>

<tr>
<td class="org-left">0-3, 3-6, 6-9</td>
<td class="org-left">Folded after 9</td>
<td class="org-right">8.458</td>
<td class="org-right">0.999</td>
</tr>

<tr>
<td class="org-left"><a href="red">0-3, 3-6, 6-9</a></td>
<td class="org-left"><a href="red">Omitted after 9</a></td>
<td class="org-right"><a href="red">8.458</a></td>
<td class="org-right"><a href="red">0.999</a></td>
</tr>
</tbody>
</table>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 2:</span> Voice 2 binned differently with different interval treatments. The selected version (red line) takes into account the jump in measure 25 &amp; the octave jump in 27.</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>

<colgroup>
<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Bins</th>
<th scope="col" class="org-left">Intervals</th>
<th scope="col" class="org-right">\(d_{f}\)</th>
<th scope="col" class="org-right">\(R^{2}\)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">0-3, 3-6, 6-9, 9-12</td>
<td class="org-left">Omitted after 12</td>
<td class="org-right">6.790</td>
<td class="org-right">0.874</td>
</tr>

<tr>
<td class="org-left">0-3, 3-6, 6-12</td>
<td class="org-left">Folded after 16</td>
<td class="org-right">5.725</td>
<td class="org-right">0.994</td>
</tr>

<tr>
<td class="org-left">0-3, 3-6, 6-10</td>
<td class="org-left">Folded after 11</td>
<td class="org-right">6.880</td>
<td class="org-right">0.99996</td>
</tr>

<tr>
<td class="org-left"><a href="red">0-3, 3-6, 6-9</a></td>
<td class="org-left"><a href="red">Omitted after 9</a></td>
<td class="org-right"><a href="red">7.666</a></td>
<td class="org-right"><a href="red">0.995</a></td>
</tr>
</tbody>
</table>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 3:</span> Voice 3 binned differently with different interval treatments. The selected version (red line) takes into account the jump in measures 12-13.</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>

<colgroup>
<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Bins</th>
<th scope="col" class="org-left">Intervals</th>
<th scope="col" class="org-right">\(d_{f}\)</th>
<th scope="col" class="org-right">\(R^{2}\)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">0-3, 3-6, 6-9, 9-12, 12-16</td>
<td class="org-left">Omitted after 16</td>
<td class="org-right">5.070</td>
<td class="org-right">0.868</td>
</tr>

<tr>
<td class="org-left">0-4, 4-8, 8-12</td>
<td class="org-left">Folded after 12</td>
<td class="org-right">5.723</td>
<td class="org-right">0.922</td>
</tr>

<tr>
<td class="org-left">0-4, 4-8, 8-12, 12-16</td>
<td class="org-left">Folded after 16</td>
<td class="org-right">5.099</td>
<td class="org-right">0.927</td>
</tr>

<tr>
<td class="org-left">0-3, 3-6, 6-9, 9-12</td>
<td class="org-left">Folded after 12</td>
<td class="org-right">5.940</td>
<td class="org-right">0.936</td>
</tr>

<tr>
<td class="org-left"><a href="red">0-3, 3-6, 6-9, 9-12</a></td>
<td class="org-left"><a href="red">Omitted after 12</a></td>
<td class="org-right"><a href="red">5.924</a></td>
<td class="org-right"><a href="red">0.933</a></td>
</tr>
</tbody>
</table>

<table border="2" cellspacing="0" cellpadding="6" rules="all" frame="border">
<caption class="t-above"><span class="table-number">Table 4:</span> Voice 4 binned differently with different interval treatments.</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>

<colgroup>
<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Bins</th>
<th scope="col" class="org-left">Intervals</th>
<th scope="col" class="org-right">\(d_{f}\)</th>
<th scope="col" class="org-right">\(R^{2}\)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">0-3, 3-6, 6-9, 9-12</td>
<td class="org-left">Folded after 12</td>
<td class="org-right">6.353</td>
<td class="org-right">0.876</td>
</tr>

<tr>
<td class="org-left">0-4, 4-8, 8-12</td>
<td class="org-left">Folded after 12</td>
<td class="org-right">5.723</td>
<td class="org-right">0.922</td>
</tr>

<tr>
<td class="org-left">0-4, 4-8, 8-12, 12-16</td>
<td class="org-left">Folded after 16</td>
<td class="org-right">6.092</td>
<td class="org-right">0.983</td>
</tr>

<tr>
<td class="org-left">0-5, 5-10, 10-16</td>
<td class="org-left">Folded after 16</td>
<td class="org-right">7.024</td>
<td class="org-right">0.999</td>
</tr>

<tr>
<td class="org-left"><a href="red">0-5, 5-10, 10-16</a></td>
<td class="org-left"><a href="red">Omitted after 16</a></td>
<td class="org-right"><a href="red">7.247</a></td>
<td class="org-right"><a href="red">0.998</a></td>
</tr>
</tbody>
</table>
<p>
The selected version for the analysis with all the voices (red line) assumes that a jump of up to a a tenth (16 semitones) is reasonable but that jumps greater than that are to evoke a very special and out-of-the-ordinary effect.<br />
</p>

<p>
<br />
<br />
<br />
<br />
<br />
</p>

<p align="right">
<a href="#org1d17b1f" align="right">Back to the sitemap</a> <sup><a id="fnr.3" class="footref" href="#fn.3">3</a></sup><br />
</p>

<p>
<br />
<br />
</p>
</div>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1">1</a></sup> <div class="footpara"><p class="footpara">
H. J. Brothers, Intervallic scaling in the Bach cello suites, Fractals, 4 (2009) 537–545.<br />
</p></div></div>

<div class="footdef"><sup><a id="fn.2" class="footnum" href="#fnr.2">2</a></sup> <div class="footpara"><p class="footpara">
K. Hsu and A. Hsu, Fractal geometry of music, Proc. Natl. Acad. Sci. USA, 87 (1990) 938–941.<br />
</p></div></div>

<div class="footdef"><sup><a id="fn.3" class="footnum" href="#fnr.3">3</a></sup> <div class="footpara"><p class="footpara">
This webpage was built with Org mode, using <a href="https://github.com/fniessen/org-html-themes">fniessen's org-html-themes</a> and <a href="https://github.com/SystemCrafters/org-website-example">System Crafters's Org website publishing example</a>, along with <a href="https://github.com/gjbae1212/hit-counter">gjbae1212's hit counter</a>.<br />
</p></div></div>


</div>
</div></div>
<div id="postamble" class="status">
<p class="author">Author: Dr. Francisco Kim</p>
<p class="email">Email: <a href="mailto:francisco.kim@alumni.ethz.ch">francisco.kim@alumni.ethz.ch</a></p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
